(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){},21:function(e,t,n){e.exports=n(50)},26:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(17),i=n.n(o),s=(n(26),n(3)),l=n(4),c=n(6),u=n(5),m=n(7),p=n(2),d=(n(10),n(9)),h=n.n(d),f=n(18),v=n.n(f),k=[{name:"Madman Espresso",type:"Cafe",address:"54 University Pl, New York, NY 10003",comedian:"Alec Baldwin"},{name:"Massapequa Diner",type:"Diner",address:"4420 Sunrise Hwy, Massapequa, NY 11758",comedian:"Alec Baldwin"},{name:"Via Quadronno",type:"Restaurant",address:"25 E 73rd St, New York, NY 10021",comedian:"Kate McKinnon"},{name:"Capizzi",type:"Restaurant",address:"547 9th Ave, New York, NY 10018",comedian:"John Mulaney"},{name:"Hastings Center Restaurant",type:"Restaurant",address:"540 Warburton Ave, Hastings-On-Hudson, NY 10706",comedian:"Hasan Minhaj"},{name:"Raymond's",type:"Diner",address:"101 E Ridgewood Ave, Ridgewood, NJ 07450",comedian:"Tracy Morgan"},{name:"2nd Ave Deli",type:"Restaurant",address:"162 E 33rd St, New York, NY 10016",comedian:"Jim Gaffigan"},{name:"Pleasantville Diner Restaurant",type:"Diner",address:"10 Memorial Plaza, Pleasantville, NY 10570",comedian:"Steve Martin"},{name:"The Butcher's Daughter",type:"Cafe",address:"581 Hudson St, New York, NY 10014",comedian:"Cedric The Entertainer"},{name:"Junior's Restaurant",type:"Diner",address:"386 Flatbush Ave Ext, Brooklyn, NY 11201",comedian:"Lewis Black"},{name:"Allswell",type:"Restaurant",address:"124 Bedford Ave, Brooklyn, NY 11211",comedian:"John Oliver"},{name:"Monkey Bar",type:"Restaurant",address:"60 E 54th St, New York, NY 10022",comedian:"Lorne Michaels"},{name:"Bluestone Coffee Company",type:"Cafe",address:"123 Watchung Ave #2, Montclair, NJ 07043",comedian:"Stephen Colbert"},{name:"One Girl Cookies",type:"Cafe",address:"33 Main St, Brooklyn, NY 11201",comedian:"Trevor Noah"},{name:"Colony Diner",type:"Diner",address:"2019 Hempstead Turnpike, East Meadow, NY 11554",comedian:"Sarah Jessica Parker"}],y=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"createList",value:function(e){var t=this,n=e.map(function(e){return"All"===t.props.selection?r.a.createElement("li",{key:e.name,onKeyDown:function(n){return t.props.itemClick(e.name,n)},onClick:function(n){return t.props.itemClick(e.name,n)},className:"list-item",role:"button",tabIndex:"0"},e.name):t.props.selection===e.category?r.a.createElement("li",{key:e.name,onKeyDown:function(n){return t.props.itemClick(e.name,n)},onClick:function(n){return t.props.itemClick(e.name,n)},className:"list-item",role:"button",tabIndex:"0"},e.name):n});return n}},{key:"render",value:function(){var e="";return e=this.props.markers!==[]?this.createList(this.props.markers):r.a.createElement("li",{className:"error-msg"},"There was a problem loading venue data. Try refreshing."),r.a.createElement("ul",{ref:this.props.listRef,className:"menu-items-container"},e)}}]),t}(a.Component),b=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("nav",{className:"select-container","aria-labelledby":"filter-list"},r.a.createElement("label",{htmlFor:"filter-list"},"Venues visited in the show",r.a.createElement("span",{id:"title"},"Comedians in Cars Getting Coffee")),r.a.createElement("select",{id:"filter-list",value:this.props.selection,onChange:function(t){return e.props.onSelection(t)}},["All","Cafe","Diner","Restaurant"].map(function(e){return r.a.createElement("option",{key:e,value:e},e)})))}}]),t}(a.Component),g=n(8),w=n(19),E=n(20);g.b.add(E.a);var N=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.buttonRef.current.focus()}},{key:"render",value:function(){var e=this,t=null,n=null,a=null,o="",i="";if(""!==this.props.venue.details){if(null!=this.props.venue.details.response.venue.rating&&(t=this.props.venue.details.response.venue.rating),null!=this.props.venue.details.response.venue.bestPhoto){var s=this.props.venue.details.response.venue.bestPhoto.prefix,l=this.props.venue.details.response.venue.bestPhoto.suffix;if(null!=s&&null!=l){var c=s+"300x300"+l;o=r.a.createElement("span",{className:"popup-img",style:{backgroundImage:"url(".concat(c,")")},role:"img","aria-label":this.props.venue.name})}}if(null!=this.props.venue.details.response.venue.price&&(n=this.props.venue.details.response.venue.price.tier,a=this.props.venue.details.response.venue.price.message,null!=n&&null!=a)){for(var u=[],m=0;m<n;m++)u.push(r.a.createElement(w.a,{"aria-hidden":!0,title:"Venue price",key:m,icon:"dollar-sign"}));i=r.a.createElement("div",{className:"price"},u,r.a.createElement("span",{className:"sr-only"},"Venue price point is ",a))}}return r.a.createElement("article",{className:"my-popup"},o,r.a.createElement("div",{className:"popup-overlay"},r.a.createElement("div",{className:"popup-text"},r.a.createElement("div",{className:"overview"},r.a.createElement("span",{className:"comedian"},"Seinfeld")," had coffee here with ",r.a.createElement("span",{className:"comedian"},this.props.venue.comedian)),r.a.createElement("p",{className:"venue-type"},this.props.venue.category),null!=t?r.a.createElement("div",{className:"rating"},r.a.createElement("div",{"aria-hidden":!0,title:"rating"},t,"/10"),r.a.createElement("span",{className:"sr-only"},"Venue rating is ",t," out of 10.")):"",i,r.a.createElement("address",{className:"venue-details"},this.props.venue.address)),r.a.createElement("button",{tabIndex:"0",ref:this.props.buttonRef,id:"close-popup",onKeyDown:function(t){return e.props.close(t)},onClick:function(t){return e.props.close(t)},"aria-label":"close"},"X")))}}]),t}(a.Component);h.a.accessToken="pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA";var S="PPYFQDE4ES3RAZHYQRKXI0RPWURQ1RPIAIU3VHENMNSKEX1S",C="XAWDVQKUAC1OBT5JUSALYUJTN34FA3H5YZPTFN3145OUM5CL",j=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).markerRef=[],n.totalMarkers=k.length;for(var a=0;a<n.totalMarkers;a++)n.markerRef.push(r.a.createRef());return n.listItemsRef=r.a.createRef(),n.buttonEl=r.a.createRef(),window.innerWidth<450?n.zoomlevel=7.5:window.innerWidth>1070?n.zoomlevel=9:n.zoomlevel=8,n.state={lng:-73.8226071,lat:40.8786204,zoom:n.zoomlevel,markers:[],selection:"All",open:"",details:"",error:!1},n.itemClick=n.itemClick.bind(Object(p.a)(Object(p.a)(n))),n.onSelection=n.onSelection.bind(Object(p.a)(Object(p.a)(n))),n.recenterMap=n.recenterMap.bind(Object(p.a)(Object(p.a)(n))),n.zoomTo=n.zoomTo.bind(Object(p.a)(Object(p.a)(n))),n.markerClick=n.markerClick.bind(Object(p.a)(Object(p.a)(n))),n.rmMenuItemStyle=n.rmMenuItemStyle.bind(Object(p.a)(Object(p.a)(n))),n.rmMarkerStyle=n.rmMarkerStyle.bind(Object(p.a)(Object(p.a)(n))),n.closePopup=n.closePopup.bind(Object(p.a)(Object(p.a)(n))),n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"closePopup",value:function(e){if("click"===e.type||"Enter"===e.key||" "===e.key||"Spacebar"===e.key||"Tab"===e.key){this.rmMarkerStyle();var t=this.rmMenuItemStyle();"keydown"===e.type&&t.focus(),this.setState({open:""})}}},{key:"recenterMap",value:function(){var e=8;window.innerWidth<450?e=7.5:window.innerWidth>1070&&(e=9),this.map.flyTo({center:[this.state.lng,this.state.lat],zoom:e}),this.setState({open:""})}},{key:"zoomTo",value:function(e){var t=-.04,n=0;window.innerWidth>600&&(t=-.03,n=-.01),this.map.flyTo({center:[e.marker._lngLat.lng+t,e.marker._lngLat.lat+n],zoom:10.5}),this.setState({open:e})}},{key:"markerClick",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.rmMarkerStyle();var n="",a="";if(""!==t){var r=t.target;a=r,n=this.state.markers[r.id],this.itemClick(n.name,"")}else this.state.markers.forEach(function(t,r){t.name===e&&(n=t,a=document.getElementById(r))});a.classList.toggle("open-marker"),this.zoomTo(n)}},{key:"rmMarkerStyle",value:function(){var e=document.querySelector(".open-marker");null!=e&&e.classList.toggle("open-marker")}},{key:"rmMenuItemStyle",value:function(){var e=document.querySelector(".open");return null!=e&&e.classList.toggle("open"),e}},{key:"itemClick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(this.rmMenuItemStyle(),"click"===t.type||" "===t.key||"Spacebar"===t.key)t.target.classList.toggle("open"),this.markerClick(e,"");else if(""===t){var n=this.listItemsRef.current.childNodes;for(var a in n)n[a].textContent===e&&n[a].classList.toggle("open")}}},{key:"onSelection",value:function(e){this.rmMarkerStyle(),this.rmMenuItemStyle(),this.setState({selection:e.target.value}),this.recenterMap()}},{key:"componentDidMount",value:function(){var e=this,t=this.state,n=t.lng,a=t.lat,r=t.zoom;this.map=new h.a.Map({container:"map",style:"mapbox://styles/mapbox/light-v9",center:[n,a],zoom:r}).on("data",function(){e.setState({error:!1})}).on("error",function(t){console.log(t),e.setState({error:!0})});var o=v()({accessToken:h.a.accessToken}),i=[];k.forEach(function(e){var t=o.forwardGeocode({query:e.address,limit:1}).send().then(function(t){if(null!=t&&null==t.error){var n=t.body.features[0];return n.properties={title:e.name,description:e.type,comedian:e.comedian},n}return e.name}).catch(function(t){return console.log(t),e.name});i.push(t)});var s=[];Promise.all(i).then(function(t){var n=0;t.forEach(function(t){if("object"===typeof t){var a=new h.a.Marker(e.markerRef[n].current).setLngLat(t.geometry.coordinates),r={name:t.properties.title,category:t.properties.description,address:t.place_name,comedian:t.properties.comedian,marker:a,vID:"",details:""};s.push(r)}else alert("There was a problem loading data for ".concat(t,"."));n++}),e.setState({markers:s})})}},{key:"componentDidUpdate",value:function(){var e=this;if(""===this.state.details){this.setState({details:"fetching"}),console.log("fetching");var t=[],n=this.state.markers,a=0;n.forEach(function(e){var n=fetch("https://api.foursquare.com/v2/venues/search?client_id=".concat(S,"&client_secret=").concat(C,"&v=20180323&limit=2&ll=").concat(e.marker._lngLat.lat,",").concat(e.marker._lngLat.lng,"&query=").concat(e.name)).then(function(e){return e.json()}).then(function(t){var n=null;return t.response.venues.map(function(t){return t.name===e.name&&(n=t.id),n}),n}).catch(function(e){return console.log(e),a+=1,null});t.push(n)}),Promise.all(t).then(function(t){n.forEach(function(e,n){null!=t[n]&&fetch("https://api.foursquare.com/v2/venues/".concat(t[n],"?client_id=").concat(S,"&client_secret=").concat(C,"&v=20180923")).then(function(e){return e.json()}).then(function(t){e.details=t})}),e.setState({markers:n}),e.setState({details:"fetched"}),console.log("fetched"),a>0&&(a="".concat(a,1===a?" venue":" venues"),alert("There was a problem loading details for ".concat(a,".")))})}}},{key:"render",value:function(){var e=this;this.state.markers.forEach(function(t){"All"!==e.state.selection?e.state.selection===t.category?t.marker.addTo(e.map):t.marker.remove():t.marker.addTo(e.map)});var t="";if(""!==this.state.open){var n=this.state.open;t=r.a.createElement(N,{className:"my-popup",venue:n,buttonRef:this.buttonEl,close:this.closePopup})}var o=0,i="";return this.state.error&&(i=r.a.createElement("div",{className:"alert"},"There was a problem loading the map")),r.a.createElement(a.Fragment,null,i,r.a.createElement("section",{role:"presentation","aria-label":"Map view of listed venues",id:"map"}),r.a.createElement("section",{"aria-label":"Filterable list of venues",className:"sidebar pad2"},r.a.createElement(b,{selection:this.state.selection,onSelection:this.onSelection}),r.a.createElement(y,{listRef:this.listItemsRef,selection:this.state.selection,itemClick:this.itemClick,markers:0!==this.state.markers.length?this.state.markers:[]}),r.a.createElement("footer",{className:"app-info"},r.a.createElement("p",null,r.a.createElement("i",null,"This web app was built with React and uses Mapbox GL JS and Foursquare\u2019s Places APIs.")))),r.a.createElement("section",{id:"popup","aria-live":"polite","aria-label":"Venue details"},t),this.markerRef.map(function(t){return o++,r.a.createElement("div",{className:"marker",id:o-1,key:o,ref:t,onClick:function(t){return e.markerClick("",t)}})}))}}]),t}(a.Component),O=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(r.a.createElement(j,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/coffee-map",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/coffee-map","/service-worker.js");O?(function(e,t){fetch(e).then(function(n){404===n.status||-1===n.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):M(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode."),alert("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):M(t,e)})}}()}},[[21,2,1]]]);
//# sourceMappingURL=main.9c4bdce8.chunk.js.map